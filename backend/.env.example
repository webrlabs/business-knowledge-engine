# =============================================================================
# Business Knowledge Engine - Backend Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values for your environment.
# All URLs should NOT include trailing slashes.
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=8080
API_PORT=8678
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Azure AD / Entra ID Authentication (REQUIRED)
# -----------------------------------------------------------------------------
# Tenant ID from Azure AD (Directory ID)
AZURE_AD_TENANT_ID=your-tenant-id

# Application (Client) ID for the backend API
AZURE_AD_CLIENT_ID=your-backend-client-id

# API Audience (usually the Application ID URI)
# Format: api://your-backend-client-id
AZURE_AD_AUDIENCE=api://your-backend-client-id

# Client Secret (OPTIONAL - required for On-Behalf-Of flow and client credentials)
# Only needed if calling downstream APIs on behalf of users
# AZURE_AD_CLIENT_SECRET=your-client-secret

# -----------------------------------------------------------------------------
# Azure OpenAI Service (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID) - no API key needed
# -----------------------------------------------------------------------------
# OpenAI endpoint URL (without trailing slash)
AZURE_OPENAI_ENDPOINT=https://your-openai.openai.azure.com

# Deployment name for chat completions (e.g., gpt-4, gpt-35-turbo)
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4

# Deployment name for embeddings (e.g., text-embedding-ada-002)
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002

# API version for OpenAI
AZURE_OPENAI_API_VERSION=2024-02-15-preview

# -----------------------------------------------------------------------------
# Azure Document Intelligence (Form Recognizer) (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID) - no API key needed
# -----------------------------------------------------------------------------
AZURE_FORM_RECOGNIZER_ENDPOINT=https://your-docint.cognitiveservices.azure.com

# -----------------------------------------------------------------------------
# Azure AI Search (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID) - no API key needed
# -----------------------------------------------------------------------------
AZURE_SEARCH_ENDPOINT=https://your-search.search.windows.net
AZURE_SEARCH_INDEX_NAME=documents

# -----------------------------------------------------------------------------
# Azure Cosmos DB - SQL API (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID) for data plane operations
# -----------------------------------------------------------------------------
COSMOS_DB_ENDPOINT=https://your-cosmos.documents.azure.com:443

# Database and container names
COSMOS_DB_DATABASE=knowledge-platform
COSMOS_DB_DOCUMENTS_CONTAINER=documents
COSMOS_DB_AUDIT_CONTAINER=audit-logs

# Optional: Use connection string instead of Entra ID
# COSMOS_DB_KEY=your-cosmos-primary-key

# -----------------------------------------------------------------------------
# Azure Cosmos DB - Gremlin API for Knowledge Graph (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID)
# -----------------------------------------------------------------------------
# WebSocket endpoint for Gremlin
COSMOS_GREMLIN_ENDPOINT=wss://your-gremlin.gremlin.cosmos.azure.com:443/

# Database and graph names
COSMOS_GREMLIN_DATABASE=knowledge-graph
COSMOS_GREMLIN_GRAPH=entities

# -----------------------------------------------------------------------------
# Azure Blob Storage (REQUIRED)
# Auth: Uses DefaultAzureCredential (Entra ID) - no connection string needed
# -----------------------------------------------------------------------------
# Storage account name (required for Entra ID auth)
AZURE_STORAGE_ACCOUNT_NAME=yourstorageaccount

# Container for uploaded documents
AZURE_STORAGE_CONTAINER_DOCUMENTS=documents

# Optional: Use connection string instead of Entra ID
# AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=...

# -----------------------------------------------------------------------------
# Azure Key Vault (OPTIONAL - for secret management)
# Auth: Uses DefaultAzureCredential (Entra ID)
# -----------------------------------------------------------------------------
KEYVAULT_URI=https://your-keyvault.vault.azure.net/

# -----------------------------------------------------------------------------
# Rate Limiting (OPTIONAL - defaults shown)
# -----------------------------------------------------------------------------
# RATE_LIMIT_WINDOW_MS=900000
# RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# OpenAI Rate Limiting (OPTIONAL - for token bucket)
# -----------------------------------------------------------------------------
OPENAI_RPM_LIMIT=60
OPENAI_TPM_LIMIT=90000

# -----------------------------------------------------------------------------
# Feature Toggles (OPTIONAL - for enabling/disabling features)
# -----------------------------------------------------------------------------
# PII Redaction - automatically redacts personal information from responses
# Set to 'false' to disable (enabled by default)
# ENABLE_PII_REDACTION=true

# Security Trimming - filters results based on user roles and classification
# Configured via security-trimming-service options (enabled by default)

# Telemetry - Application Insights integration
# Automatically enabled when APPINSIGHTS_INSTRUMENTATIONKEY is set
